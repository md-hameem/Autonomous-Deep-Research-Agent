Role: You are a Senior AI Engineer specializing in Agentic Workflows using LangGraph and Python.

Objective: Build a CLI-based "Autonomous Deep Research Agent". The agent receives a high-level topic from the user, creates a research plan, executes web searches to gather data, and compiles a comprehensive markdown report.

Tech Stack:

Language: Python 3.11+

Orchestration: LangGraph (specifically StateGraph)

LLM Interface: LangChain (ChatAnthropic or ChatOpenAI)

Search Tool: Tavily API (tavily-python)

Data Validation: Pydantic (for structured output from the planner)

1. Architecture & State Management
The State (state.py): Define a TypedDict named AgentState to manage the context. It must contain:

topic (str): The user's original query.

plan (list[str]): A list of search queries generated by the planner.

research_data (list[str]): A compilation of snippets/content gathered from searches.

final_report (str): The generated markdown output.

revision_number (int): To track iterations (optional, for loop limits).

2. The Nodes (nodes.py)
Create the following functions (nodes) that take AgentState as input and return an update to the state:

Node A: plan_research

Input: topic

Action: Use the LLM to break the topic into 3-5 distinct, targeted search queries.

Output: Updates the plan key in the state.

Node B: execute_search

Input: plan

Action: Iterate through the queries in plan. Use the Tavily API to perform searches. Collect the top 2-3 results per query.

Output: Appends the raw search content to research_data.

Node C: write_report

Input: research_data, topic

Action: Pass the accumulated research data to the LLM. Instruct it to write a structured report with headers, bullet points, and sources.

Output: Updates final_report.

3. The Graph (graph.py)
Initialize a StateGraph(AgentState).

Add the nodes: planner, researcher, writer.

Define the Edge Flow: START -> planner -> researcher -> writer -> END.

Compile the graph.

4. Implementation Details
Environment: Use python-dotenv to load TAVILY_API_KEY and ANTHROPIC_API_KEY.

Error Handling: If the search returns empty results, the agent should not crash; it should note the lack of data in the research_data.

Formatting: The final report must be in standard Markdown.

5. Expected Deliverables
Please generate the code for the following file structure:

requirements.txt (List all dependencies)

.env.example (Template for API keys)

state.py (The state definition)

nodes.py (The logic for the 3 nodes)

graph.py (The workflow definition)

main.py (The entry point to run the agent)

Constraint: ensure the code uses the latest version of langgraph syntax.